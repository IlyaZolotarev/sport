/* Mobile-first, no-scroll layout */
:root{
  --bg0:#070A12;
  --bg1:#0B1022;
  --card:#0f172aCC;
  --cardSolid:#0f172a;
  --text:#EAF0FF;
  --muted:#AAB6DA;
  --muted2:#7F8BB6;
  --stroke:#263052;
  --stroke2:#1a2444;
  --accent:#7C5CFF;
  --accent2:#22D3EE;
  --good:#34D399;
  --warn:#FBBF24;
  --bad:#FB7185;

  --r:20px;
  --shadow: 0 18px 60px rgba(0,0,0,.55);

  --vh: 1vh;
}

*{box-sizing:border-box;}
html,body{height:100%; margin:0;}
body{
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  background: radial-gradient(1200px 900px at 10% 10%, #172554 0%, transparent 45%),
              radial-gradient(1200px 900px at 90% 30%, #312e81 0%, transparent 50%),
              linear-gradient(180deg, var(--bg0), var(--bg1));
  color: var(--text);
  overflow:hidden; /* prevent page scrolling */
}

.bg{
  position:fixed; inset:0; pointer-events:none; overflow:hidden;
}
.bg__blob{
  position:absolute; width:56vmax; height:56vmax; border-radius:999px;
  filter: blur(30px);
  opacity:.22;
  transform: translate3d(0,0,0);
  animation: floaty 10s ease-in-out infinite;
}
.bg__blob.b1{ left:-18vmax; top:-18vmax; background: radial-gradient(circle at 30% 30%, var(--accent), transparent 60%); }
.bg__blob.b2{ right:-22vmax; bottom:-20vmax; background: radial-gradient(circle at 30% 30%, var(--accent2), transparent 60%); animation-duration: 13s; }
.bg__grid{
  position:absolute; inset:-2px;
  background-image:
    linear-gradient(to right, rgba(255,255,255,.05) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255,255,255,.05) 1px, transparent 1px);
  background-size: 44px 44px;
  mask-image: radial-gradient(circle at 50% 40%, rgba(0,0,0,1) 0%, rgba(0,0,0,.2) 40%, rgba(0,0,0,0) 72%);
  opacity:.22;
}

@keyframes floaty{
  0%,100%{ transform: translate3d(0,0,0) scale(1); }
  50%{ transform: translate3d(3vmax, -2vmax,0) scale(1.04); }
}

.app{
  position:relative;
  height: 100vh;
  height: calc(var(--vh) * 100);
  padding: max(12px, env(safe-area-inset-top)) 12px max(12px, env(safe-area-inset-bottom)) 12px;
  display:flex;
  flex-direction:column;
  gap:10px;
  max-width: 720px;
  margin: 0 auto;
}

.topbar{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px;
  padding: 4px 2px;
}
.brand{display:flex; gap:10px; align-items:center;}
.brand__logo{
  width:40px; height:40px; border-radius:14px;
  background: linear-gradient(135deg, rgba(124,92,255,.25), rgba(34,211,238,.20));
  border:1px solid rgba(255,255,255,.10);
  position:relative;
  box-shadow: 0 12px 34px rgba(0,0,0,.35);
  overflow:hidden;
}
.logoPulse{
  position:absolute; inset:-30%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 55%);
  animation: shine 2.8s ease-in-out infinite;
}
.logoBolt{
  position:absolute; inset:0; display:grid; place-items:center;
  font-size:18px;
  text-shadow: 0 10px 20px rgba(0,0,0,.45);
}
@keyframes shine{
  0%,100%{ transform: translate(-8%, 10%) rotate(0deg); opacity:.9;}
  50%{ transform: translate(10%, -8%) rotate(12deg); opacity:1;}
}
.brand__name{font-weight:750; letter-spacing:.2px; line-height:1;}
.brand__tag{font-size:12px; color:var(--muted); margin-top:2px;}
.iconBtn{
  width:44px; height:44px;
  border-radius:14px;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.10);
  color: var(--text);
  font-size:18px;
  cursor:pointer;
  transition: transform .15s ease, background .15s ease;
}
.iconBtn:active{ transform: scale(.98); background: rgba(255,255,255,.09); }

.card{
  flex: 1 1 auto;
  border-radius: var(--r);
  background: linear-gradient(180deg, rgba(15,23,42,.86), rgba(15,23,42,.64));
  border:1px solid rgba(255,255,255,.10);
  box-shadow: var(--shadow);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  min-height: 0;
}

.card__top{
  padding: 12px 12px 10px 12px;
  display:flex;
  gap:10px;
  align-items:center;
  border-bottom: 1px solid rgba(255,255,255,.08);
  background: linear-gradient(180deg, rgba(255,255,255,.05), transparent);
}
.backBtn{
  width:44px; height:44px;
  border-radius: 14px;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.10);
  color: var(--text);
  font-size:18px;
  cursor:pointer;
  transition: transform .15s ease, background .15s ease, opacity .2s ease;
}
.backBtn[disabled]{ opacity:.35; cursor:not-allowed; }
.backBtn:active{ transform: scale(.98); background: rgba(255,255,255,.09); }

.progressWrap{flex:1; min-width:0;}
.progressMeta{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 8px;
}
.pill{
  padding: 6px 10px;
  border-radius: 999px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.05);
  color: var(--text);
  white-space:nowrap;
}

.progress{
  height: 10px;
  border-radius: 999px;
  background: rgba(255,255,255,.08);
  overflow:hidden;
  border:1px solid rgba(255,255,255,.10);
}
.progress__bar{
  height:100%;
  width: 0%;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  border-radius: 999px;
  transition: width .35s ease;
}

.card__body{
  padding: 12px 14px 12px 14px;
  display:flex;
  flex-direction:column;
  gap:10px;
  min-height:0;
  height: 100%;
}

.qIcon{
  width:44px; height:44px;
  border-radius: 16px;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.10);
  display:grid;
  place-items:center;
  font-size:20px;
  box-shadow: 0 12px 30px rgba(0,0,0,.28);
  overflow:hidden;
  position:relative;
}
.qIcon::after{
  content:"";
  position:absolute; inset:-40%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), transparent 58%);
  transform: translate(-10%, 10%);
  animation: iconShine 3.2s ease-in-out infinite;
}
@keyframes iconShine{
  0%,100%{ transform: translate(-12%, 8%); opacity:.9; }
  50%{ transform: translate(14%, -10%); opacity:1; }
}

.qTitle{
  margin:0;
  font-size: clamp(16px, 4.7vw, 22px);
  line-height: 1.12;
  letter-spacing: .1px;
}
.qSub{
  margin:0;
  font-size: clamp(12px, 3.4vw, 14px);
  color: var(--muted);
  line-height: 1.25;
}

.options{
  display:grid;
  grid-template-columns: 1fr;
  gap:10px;
  flex: 1 1 auto;
  min-height:0;
  align-content:start;
}

@media (min-width: 420px){
  .options{ grid-template-columns: 1fr 1fr; }
  .options .opt:nth-child(5){ grid-column: 1 / -1; }
}

.opt{
  border-radius: 16px;
  border:1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.06);
  padding: 12px 12px;
  cursor:pointer;
  user-select:none;
  transition: transform .14s ease, background .14s ease, border-color .14s ease, box-shadow .14s ease;
  display:flex;
  align-items:center;
  gap:10px;
  min-height: 48px;
  position:relative;
  overflow:hidden;
}
.opt::before{
  content:"";
  position:absolute; inset:-60%;
  background: radial-gradient(circle at 30% 30%, rgba(124,92,255,.18), transparent 55%);
  opacity:0;
  transform: translate(-10%, 10%);
  transition: opacity .18s ease;
}
.opt:hover::before{ opacity:.65; }
.opt:active{ transform: scale(.99); }
.opt__icon{
  width:34px; height:34px;
  border-radius: 14px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
  display:grid; place-items:center;
  flex: 0 0 auto;
}
.opt__text{
  font-size: clamp(12px, 3.5vw, 14px);
  line-height: 1.15;
  color: var(--text);
}
.opt__meta{
  margin-left:auto;
  color: var(--muted2);
  font-size: 12px;
}
.opt.isSelected{
  border-color: rgba(34,211,238,.55);
  box-shadow: 0 0 0 3px rgba(34,211,238,.10);
  background: rgba(34,211,238,.08);
}
.opt.isLocked{ cursor: default; opacity:.92; }
.opt.isLocked:hover::before{ opacity:0; }

.actions{
  display:flex; gap:10px;
  align-items:center;
  justify-content:space-between;
}
.ghostBtn, .primaryBtn{
  height: 44px;
  border-radius: 14px;
  border:1px solid rgba(255,255,255,.10);
  cursor:pointer;
  font-weight: 650;
  letter-spacing:.1px;
}
.ghostBtn{
  flex: 1 1 auto;
  background: rgba(255,255,255,.05);
  color: var(--text);
}
.primaryBtn{
  flex: 1 1 auto;
  background: linear-gradient(90deg, rgba(124,92,255,.95), rgba(34,211,238,.90));
  color: #071018;
  border-color: rgba(255,255,255,.12);
  box-shadow: 0 14px 34px rgba(0,0,0,.28);
  transition: transform .12s ease, filter .12s ease, opacity .2s ease;
}
.primaryBtn[disabled]{ opacity:.45; cursor:not-allowed; filter:saturate(.6); }
.primaryBtn:active{ transform: scale(.99); }

.toast{
  min-height: 18px;
  font-size: 12px;
  color: var(--muted);
  opacity:0;
  transform: translateY(4px);
  transition: opacity .2s ease, transform .2s ease;
}
.toast.show{ opacity:1; transform: translateY(0); }

.footer{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding: 2px 2px 0 2px;
  color: var(--muted2);
  font-size: 12px;
}
.footLeft{display:flex; align-items:center; gap:8px;}
.dot{
  width:10px; height:10px; border-radius:999px;
  display:inline-block;
  border:1px solid rgba(255,255,255,.12);
}
.dot.ok{ background: rgba(52,211,153,.8); box-shadow: 0 0 0 4px rgba(52,211,153,.12); }
.footLink{ color: var(--muted); text-decoration:none; }
.footLink:hover{ text-decoration: underline; }

/* Overlay */
.overlay{
  position:fixed; inset:0;
  background: rgba(2,6,23,.65);
  backdrop-filter: blur(10px);
  display:none;
  align-items:center;
  justify-content:center;
  padding: 18px;
}
.overlay.isOpen{ display:flex; }
.overlayCard{
  width:min(520px, 100%);
  border-radius: 22px;
  border:1px solid rgba(255,255,255,.12);
  background: linear-gradient(180deg, rgba(15,23,42,.92), rgba(15,23,42,.78));
  box-shadow: var(--shadow);
  padding: 16px;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.overlayTop{ display:flex; align-items:center; gap:10px; }
.overlayIcon{
  width:42px; height:42px;
  border-radius: 16px;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.10);
  display:grid; place-items:center;
  font-size: 20px;
}
.overlayTitle{
  font-weight: 750;
  font-size: 16px;
}
.overlayHint{
  font-size: 12px;
  color: var(--muted);
}
.overlayVisual{
  height: 120px;
  border-radius: 18px;
  border:1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.05);
  overflow:hidden;
  position:relative;
}

/* Thinking visuals (several variants) */
.loaderDots{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  gap:10px;
}
.loaderDots span{
  width:12px; height:12px; border-radius:999px;
  background: rgba(34,211,238,.85);
  animation: dots 1.2s ease-in-out infinite;
}
.loaderDots span:nth-child(2){ animation-delay:.15s; background: rgba(124,92,255,.85); }
.loaderDots span:nth-child(3){ animation-delay:.30s; background: rgba(52,211,153,.85); }
@keyframes dots{
  0%,100%{ transform: translateY(0); opacity:.55; }
  50%{ transform: translateY(-10px); opacity:1; }
}

.loaderBar{
  position:absolute; left:14px; right:14px; top:50%;
  height: 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  overflow:hidden;
  transform: translateY(-50%);
}
.loaderBar i{
  position:absolute; left:-30%;
  width: 36%;
  height: 100%;
  border-radius:999px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  animation: bar 1.2s ease-in-out infinite;
}
@keyframes bar{
  0%{ left:-35%; }
  100%{ left: 110%; }
}

.loaderRing{
  position:absolute; inset:0;
  display:grid; place-items:center;
}
.ring{
  width:62px; height:62px;
  border-radius:999px;
  border: 7px solid rgba(255,255,255,.10);
  border-top-color: rgba(34,211,238,.9);
  animation: spin 1s linear infinite;
  box-shadow: 0 14px 30px rgba(0,0,0,.25) inset;
}
@keyframes spin{ to{ transform: rotate(360deg);} }

.loaderCards{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  gap:10px;
}
.loaderCards .c{
  width:44px; height:64px;
  border-radius: 14px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  transform-origin: center bottom;
  animation: card 1.2s ease-in-out infinite;
}
.loaderCards .c:nth-child(2){ animation-delay:.12s; }
.loaderCards .c:nth-child(3){ animation-delay:.24s; }
@keyframes card{
  0%,100%{ transform: translateY(10px) rotate(-2deg); opacity:.6; }
  50%{ transform: translateY(-8px) rotate(2deg); opacity:1; }
}

.loaderSkeleton{
  position:absolute; inset:14px;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.skLine{
  height: 14px;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.12), rgba(255,255,255,.06));
  background-size: 200% 100%;
  animation: shimmer 1.1s ease-in-out infinite;
}
.skLine.s1{ width: 90%; }
.skLine.s2{ width: 72%; }
.skLine.s3{ width: 82%; }
@keyframes shimmer{
  0%{ background-position: 0% 0; }
  100%{ background-position: 200% 0; }
}

/* Modal */
.modal{
  position:fixed; inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  padding: 18px;
}
.modal.isOpen{ display:flex; }
.modal__backdrop{
  position:absolute; inset:0;
  background: rgba(2,6,23,.65);
  backdrop-filter: blur(10px);
}
.modal__card{
  position:relative;
  width: min(520px, 100%);
  border-radius: 22px;
  border:1px solid rgba(255,255,255,.12);
  background: linear-gradient(180deg, rgba(15,23,42,.92), rgba(15,23,42,.78));
  box-shadow: var(--shadow);
  padding: 16px;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.modal__title{ font-weight: 800; font-size: 16px;}
.modal__text{ color: var(--muted); font-size: 13px; line-height: 1.35;}
.modal__btn{ width: 100%; }

@media (min-height: 740px){
  .overlayVisual{ height: 140px; }
}

@media (max-width: 340px){
  .brand__tag{ display:none; }
  .actions{ flex-direction:column; }
  .ghostBtn,.primaryBtn{ width:100%; }
}

/* Step theme hooks (set on body) */
body.theme-a .bg__blob.b1{ opacity:.22; }
body.theme-b .bg__blob.b1{ opacity:.18; background: radial-gradient(circle at 30% 30%, #FF4D8D, transparent 60%); }
body.theme-c .bg__blob.b1{ opacity:.18; background: radial-gradient(circle at 30% 30%, #F59E0B, transparent 60%); }
body.theme-d .bg__blob.b1{ opacity:.18; background: radial-gradient(circle at 30% 30%, #10B981, transparent 60%); }

body.theme-b .progress__bar{ background: linear-gradient(90deg, #FF4D8D, #22D3EE); }
body.theme-c .progress__bar{ background: linear-gradient(90deg, #F59E0B, #7C5CFF); }
body.theme-d .progress__bar{ background: linear-gradient(90deg, #10B981, #22D3EE); }

/* Tiny celebratory confetti (CSS-only) */
.confetti{
  position:absolute; inset:0; pointer-events:none;
}
.confetti i{
  position:absolute;
  width:10px; height:10px;
  border-radius:2px;
  background: rgba(34,211,238,.85);
  top:-20px;
  left: 50%;
  animation: fall 1.2s ease-out forwards;
  opacity:0;
}
.confetti i:nth-child(2){ left: 20%; background: rgba(124,92,255,.85); animation-delay:.03s;}
.confetti i:nth-child(3){ left: 78%; background: rgba(52,211,153,.85); animation-delay:.06s;}
.confetti i:nth-child(4){ left: 60%; background: rgba(251,191,36,.85); animation-delay:.09s;}
.confetti i:nth-child(5){ left: 35%; background: rgba(251,113,133,.85); animation-delay:.12s;}
@keyframes fall{
  0%{ transform: translateY(0) rotate(0deg); opacity:0; }
  15%{ opacity:1; }
  100%{ transform: translateY(180px) rotate(220deg); opacity:0; }
}
